{"version":3,"file":"blocks/accordion/accordion.js","mappings":"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","sources":["webpack://utkwds/./src/blocks/accordion/accordion.ts"],"sourcesContent":["const setUpAccordions = () => {\n\tconst accordions = document.querySelectorAll( '[data-accordion]' );\n\tconsole.log( `Found ${ accordions.length } accordions` );\n\tif ( ! accordions.length ) return;\n\n\ttype HTMLSectionElement = Omit< HTMLElement, 'tagName' > & {\n\t\ttagName: 'SECTION';\n\t};\n\n\tconst isHTMLSectionElement = (\n\t\tel: HTMLElement\n\t): el is HTMLSectionElement => el.tagName === 'SECTION';\n\n\t/*\n      The main accordion mechanism here is loosely based on:\n      - Bootstrap's `collapse.js`: https://github.com/twbs/bootstrap/blob/c3c65911665ab64bdaa15d405db65ee81655dbf3/js/src/collapse.js\n      - https://css-tricks.com/using-css-transitions-auto-dimensions/\n    */\n\n\tconst HEIGHT_TRANSITION = 'height 400ms ease';\n\t/**\n\t * Presence of this class on a panel's `section` is used in the\n\t * `Panel` instance's `.isOpen()` method to determine whether the\n\t * `section` is open.\n\t * Gets added to the `section` when open-transition finishes.\n\t * Gets removed from the `section` just before close-transition starts.\n\t */\n\tconst CLASS_NAME_IS_OPEN = 'is-open';\n\tconst CLASS_NAME_IS_OPEN_POINTER_EVENTS_AUTO =\n\t\t/* tw */ '[&.is-open]:pointer-events-auto';\n\n\tclass Panel {\n\t\tbutton: HTMLButtonElement;\n\n\t\tsection: HTMLSectionElement;\n\n\t\tconstructor( button: HTMLButtonElement, section: HTMLSectionElement ) {\n\t\t\tthis.button = button;\n\t\t\tthis.section = section;\n\n\t\t\tthis.section.style.transition = HEIGHT_TRANSITION;\n\n\t\t\t/*\n\t\t\t * Just in case: if transition is canceled, remove section's `transitionend` listeners\n\t\t\t * and set to closed state. This prevents the accordion from breaking if, say,\n\t\t\t * a breakpoint is crossed that causes it to go `display: none` *in the middle of a transition*.\n\t\t\t */\n\t\t\tsection.addEventListener(\n\t\t\t\t'transitioncancel',\n\t\t\t\t( { target, currentTarget } ) => {\n\t\t\t\t\tif ( target !== currentTarget ) return;\n\t\t\t\t\tsection.removeEventListener(\n\t\t\t\t\t\t'transitionend',\n\t\t\t\t\t\tthis._closeTransitionEnd\n\t\t\t\t\t);\n\t\t\t\t\tsection.removeEventListener(\n\t\t\t\t\t\t'transitionend',\n\t\t\t\t\t\tthis._openTransitionEnd\n\t\t\t\t\t);\n\t\t\t\t\tthis._closeImmediately();\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t/** Should run after open-transition. */\n\t\t_toOpenState() {\n\t\t\tthis.isTransitioning = false;\n\t\t\tthis.section.style.removeProperty( 'height' );\n\t\t\tthis.section.classList.add( CLASS_NAME_IS_OPEN );\n\n\t\t\t// undo making elements within section un-focusable (restoring original `tabindex` if applicable)\n\t\t\tthis.section.querySelectorAll( '*' ).forEach( ( el ) => {\n\t\t\t\tif (\n\t\t\t\t\t! ( el instanceof HTMLElement ) &&\n\t\t\t\t\t! ( el instanceof SVGElement )\n\t\t\t\t)\n\t\t\t\t\treturn;\n\t\t\t\tconst { originalTabIndex } = el.dataset;\n\t\t\t\tif ( originalTabIndex ) {\n\t\t\t\t\tel.setAttribute( 'tabindex', originalTabIndex );\n\t\t\t\t} else {\n\t\t\t\t\tel.removeAttribute( 'tabindex' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// scroll button into view if needed\n\t\t\tconst { IntersectionObserver } = window;\n\t\t\tif ( ! IntersectionObserver ) return;\n\t\t\tnew IntersectionObserver( ( [ entry ], observer ) => {\n\t\t\t\t// use 0.9 instead of 1 because of some Safari weirdness\n\t\t\t\tif ( entry.intersectionRatio < 0.9 ) {\n\t\t\t\t\tthis.button.scrollIntoView();\n\t\t\t\t}\n\t\t\t\tobserver.disconnect();\n\t\t\t} ).observe( this.button );\n\t\t}\n\n\t\t/** Should run after close-transition. */\n\t\t_toClosedState() {\n\t\t\tthis.isTransitioning = false;\n\t\t\tthis.section.setAttribute( 'aria-hidden', 'true' );\n\t\t}\n\n\t\t/** For abruptly setting to closed-state. */\n\t\t_closeImmediately() {\n\t\t\tthis.section.style.height = '0';\n\t\t\tthis.section.classList.remove( CLASS_NAME_IS_OPEN );\n\t\t\tthis.button.setAttribute( 'aria-expanded', 'false' );\n\t\t\tthis._toClosedState();\n\t\t}\n\n\t\t/**\n\t\t * Removes itself as a listener and calls `this._toOpenState()`.\n\t\t */\n\t\t_openTransitionEnd: EventListener = ( { target, currentTarget } ) => {\n\t\t\tif ( target !== currentTarget ) return;\n\t\t\tthis.section.removeEventListener(\n\t\t\t\t'transitionend',\n\t\t\t\tthis._openTransitionEnd\n\t\t\t);\n\t\t\tthis._toOpenState();\n\t\t};\n\n\t\t/**\n\t\t * Removes itself as a listener and calls `this._toClosedState()`.\n\t\t */\n\t\t_closeTransitionEnd: EventListener = ( { target, currentTarget } ) => {\n\t\t\tif ( target !== currentTarget ) return;\n\t\t\tthis.section.removeEventListener(\n\t\t\t\t'transitionend',\n\t\t\t\tthis._closeTransitionEnd\n\t\t\t);\n\t\t\tthis._toClosedState();\n\t\t};\n\n\t\tisTransitioning = false;\n\n\t\tisOpen() {\n\t\t\treturn this.section.classList.contains( CLASS_NAME_IS_OPEN );\n\t\t}\n\n\t\topen() {\n\t\t\tif ( this.isTransitioning || this.isOpen() ) return;\n\n\t\t\tthis.isTransitioning = true;\n\n\t\t\tthis.section.addEventListener(\n\t\t\t\t'transitionend',\n\t\t\t\tthis._openTransitionEnd\n\t\t\t);\n\t\t\tthis.section.setAttribute( 'aria-hidden', 'false' );\n\t\t\tthis.section.style.height = `${ this.section.scrollHeight }px`;\n\t\t\tthis.button.setAttribute( 'aria-expanded', 'true' );\n\t\t}\n\n\t\tclose() {\n\t\t\tif ( this.isTransitioning || ! this.isOpen() ) return;\n\n\t\t\tthis.isTransitioning = true;\n\n\t\t\t// prevent focus-within during transition\n\t\t\tthis.section.querySelectorAll( '*' ).forEach( ( el ) => {\n\t\t\t\tif (\n\t\t\t\t\t! ( el instanceof HTMLElement ) &&\n\t\t\t\t\t! ( el instanceof SVGElement )\n\t\t\t\t)\n\t\t\t\t\treturn;\n\t\t\t\tel.tabIndex = -1;\n\t\t\t} );\n\t\t\tif (\n\t\t\t\tthis.section.contains( document.activeElement ) &&\n\t\t\t\t( document.activeElement instanceof HTMLElement ||\n\t\t\t\t\tdocument.activeElement instanceof SVGElement )\n\t\t\t) {\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\n\t\t\tconst height = this.section.scrollHeight;\n\t\t\tthis.section.classList.remove( CLASS_NAME_IS_OPEN );\n\t\t\tthis.section.style.removeProperty( 'transition' );\n\n\t\t\trequestAnimationFrame( () => {\n\t\t\t\tthis.section.addEventListener(\n\t\t\t\t\t'transitionend',\n\t\t\t\t\tthis._closeTransitionEnd\n\t\t\t\t);\n\t\t\t\tthis.section.style.height = `${ height }px`;\n\t\t\t\tthis.section.style.transition = HEIGHT_TRANSITION;\n\n\t\t\t\trequestAnimationFrame( () => {\n\t\t\t\t\tthis.section.style.height = '0';\n\t\t\t\t\tthis.button.setAttribute( 'aria-expanded', 'false' );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\ttoggle() {\n\t\t\tif ( this.isOpen() ) {\n\t\t\t\tthis.close();\n\t\t\t} else {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Increment each time we make a new panel, so that each panel's id will be unique. */\n\tlet panelId = 1;\n\n\tfor ( const accordion of accordions ) {\n\t\tif ( ! ( accordion instanceof HTMLElement ) ) continue;\n\n\t\t/** If `true`, only one panel-section can be open at a time. */\n\t\tconst closeOthersOnOpen = accordion.matches(\n\t\t\t'[data-close-others-on-open]'\n\t\t);\n\t\t/**\n\t\t * To keep track of whether more panels can be open on load,\n\t\t * in case `closeOthersOnOpen` is `true`.\n\t\t */\n\t\tlet canOpenOnLoad = true;\n\n\t\tconst panels: Panel[] = [];\n\n\t\t/*\n\t\t * \"Prepare\" `panels` by setting up the markup and initial states,\n\t\t * but don't add event-listeners yet (`panels` must be filled first).\n\t\t */\n\t\tfor ( const el of accordion.children ) {\n\t\t\tif ( ! ( el instanceof HTMLElement ) ) continue;\n\n\t\t\tconst heading = el.querySelector( '[data-accordion-heading]' );\n\t\t\tconst section = el.querySelector( '[data-accordion-section]' );\n\n\t\t\tif ( ! ( heading instanceof HTMLHeadingElement ) ) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t'A `utk-wds-accordion__heading` element is missing or is not an h-tag.'\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (\n\t\t\t\t! ( section instanceof HTMLElement ) ||\n\t\t\t\t! isHTMLSectionElement( section )\n\t\t\t) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t'A `[data-accordion-section]` element is missing or is not a `<section>`.'\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// No more `continue`-ing allowed after this point (b/c of `canOpenOnLoad`)\n\n\t\t\tlet open = false;\n\n\t\t\tconst tryOpen = el.matches( '[data-open]' );\n\n\t\t\tif ( tryOpen && canOpenOnLoad ) {\n\t\t\t\topen = true;\n\t\t\t\tif ( closeOthersOnOpen ) {\n\t\t\t\t\tcanOpenOnLoad = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst buttonId = `accordion-button-${ panelId }`;\n\t\t\tconst sectionId = `accordion-contents-${ panelId }`;\n\t\t\tpanelId++;\n\n\t\t\tsection.id = sectionId;\n\t\t\tsection.setAttribute( 'aria-labelledby', buttonId );\n\t\t\tsection.classList.add(\n\t\t\t\t/* tw */ 'aria-hidden:hidden',\n\t\t\t\t/* tw */ 'overflow-hidden',\n\t\t\t\t/* tw */ 'pointer-events-none',\n\t\t\t\tCLASS_NAME_IS_OPEN_POINTER_EVENTS_AUTO\n\t\t\t);\n\n\t\t\t// store original tabindex for each element in section that has one\n\t\t\tsection.querySelectorAll( '*' ).forEach( ( e ) => {\n\t\t\t\tif (\n\t\t\t\t\t! ( e instanceof HTMLElement ) &&\n\t\t\t\t\t! ( e instanceof SVGElement )\n\t\t\t\t)\n\t\t\t\t\treturn;\n\t\t\t\tconst originalTabIndex = e.getAttribute( 'tabindex' );\n\t\t\t\tif ( originalTabIndex ) {\n\t\t\t\t\te.dataset.originalTabIndex = originalTabIndex;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tconst button = document.createElement( 'button' );\n\t\t\tbutton.id = buttonId;\n\t\t\tbutton.setAttribute( 'aria-controls', sectionId );\n\t\t\tbutton.textContent = heading.textContent;\n\t\t\tconst { buttonClasses } = heading.dataset;\n\t\t\tif ( buttonClasses ) {\n\t\t\t\tbutton.className = buttonClasses;\n\t\t\t}\n\n\t\t\theading.textContent = null;\n\t\t\theading.appendChild( button );\n\n\t\t\t// set initial state\n\t\t\tif ( open ) {\n\t\t\t\tsection.classList.add( CLASS_NAME_IS_OPEN );\n\t\t\t\tsection.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\tbutton.setAttribute( 'aria-expanded', 'true' );\n\t\t\t} else {\n\t\t\t\tsection.style.height = '0';\n\t\t\t\tsection.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\tbutton.setAttribute( 'aria-expanded', 'false' );\n\t\t\t}\n\n\t\t\tpanels.push( new Panel( button, section ) );\n\t\t}\n\n\t\tpanels.forEach( ( panel ) => {\n\t\t\tpanel.button.addEventListener(\n\t\t\t\t'click',\n\t\t\t\tcloseOthersOnOpen\n\t\t\t\t\t? () => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tpanels.some(\n\t\t\t\t\t\t\t\t\t( { isTransitioning } ) => isTransitioning\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\tif ( panel.isOpen() ) {\n\t\t\t\t\t\t\t\tpanel.close();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpanels.forEach( ( otherPanel ) => {\n\t\t\t\t\t\t\t\t\tif ( panel !== otherPanel ) {\n\t\t\t\t\t\t\t\t\t\totherPanel.close();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\tpanel.open();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  }\n\t\t\t\t\t: () => {\n\t\t\t\t\t\t\tpanel.toggle();\n\t\t\t\t\t  }\n\t\t\t);\n\t\t} );\n\t}\n};\n\ndocument.addEventListener( 'DOMContentLoaded', function () {\n\tconsole.log( 'Set up accordion' );\n\tsetUpAccordions();\n} );\n"],"names":["setUpAccordions","accordions","document","querySelectorAll","console","log","length","isHTMLSectionElement","el","tagName","HEIGHT_TRANSITION","CLASS_NAME_IS_OPEN","CLASS_NAME_IS_OPEN_POINTER_EVENTS_AUTO","Panel","constructor","button","section","style","transition","addEventListener","target","currentTarget","removeEventListener","_closeTransitionEnd","_openTransitionEnd","_closeImmediately","_toOpenState","isTransitioning","removeProperty","classList","add","forEach","HTMLElement","SVGElement","originalTabIndex","dataset","setAttribute","removeAttribute","IntersectionObserver","window","entry","observer","intersectionRatio","scrollIntoView","disconnect","observe","_toClosedState","height","remove","isOpen","contains","open","scrollHeight","close","tabIndex","activeElement","blur","requestAnimationFrame","toggle","panelId","accordion","closeOthersOnOpen","matches","canOpenOnLoad","panels","children","heading","querySelector","HTMLHeadingElement","error","tryOpen","buttonId","sectionId","id","e","getAttribute","createElement","textContent","buttonClasses","className","appendChild","push","panel","some","otherPanel"],"sourceRoot":""}